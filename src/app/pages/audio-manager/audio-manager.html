<div class="container mx-auto p-6 max-w-6xl">
  <h1 class="text-3xl font-bold text-gray-800">Gestor de Audios</h1>
  <p class="text-gray-600 mt-2 mb-6">Arrastra y suelta los archivos de audio en las cajas correspondientes para asociarlos a cada frase.</p>

  <div *ngIf="phrases.length === 0" class="no-phrases-message text-center p-4 bg-green-100 text-green-700 rounded-lg">
    <p>ðŸŽ‰ Â¡No hay frases pendientes! Todos los audios estÃ¡n completos. ðŸŽ‰</p>
  </div>

  <div class="phrase-list space-y-6">
    <div *ngFor="let phrase of phrases" class="phrase-card bg-white p-6 rounded-lg shadow-md border border-gray-200">
      <h2 class="text-xl font-semibold text-gray-900">{{ phrase.originalText }}</h2>
      <p *ngIf="phrase.translations.length > 0" class="text-gray-700">
        <strong>{{ phrase.translations[0].language | uppercase }}:</strong> "{{ phrase.translations[0].translatedText }}"
      </p>

      <div class="audio-slots grid grid-cols-1 md:grid-cols-3 gap-6 mt-4 border-t border-gray-200 pt-4">
        
        <div class="audio-slot">
          <label class="font-bold text-gray-600 block mb-2">Audio de Origen</label>
          <div class="drop-zone h-28 flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg"
               appDragAndDrop 
               (fileDropped)="onOriginFileDropped($event, phrase)">
            
            <div *ngIf="isOriginUploading(phrase._id)" class="spinner"></div>

            <button *ngIf="phrase.originAudioUrl && phrase.originAudioUrl !== 'audio.pendiente.mp3'; else promptOrigin" 
                    (click)="playAudio(phrase.originAudioUrl)"
                    class="flex items-center justify-center w-32 h-12 bg-teal-500 text-white font-semibold rounded-lg shadow-md hover:bg-teal-600">
              <svg *ngIf="!isPlaying(phrase.originAudioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <svg *ngIf="isPlaying(phrase.originAudioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <span>{{ isPlaying(phrase.originAudioUrl) ? 'Pausa' : 'Play' }}</span>
            </button>
            <ng-template #promptOrigin>
              <div *ngIf="!isOriginUploading(phrase._id)" class="text-gray-500">Arrastra audio (Origen)</div>
            </ng-template>
          </div>
        </div>

        <div *ngIf="phrase.translations.length > 0" class="audio-slot">
          <label class="font-bold text-gray-600 block mb-2">Voz Masculina</label>
          <div class="drop-zone h-28 flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg" appDragAndDrop (fileDropped)="onFileDropped($event, phrase._id, 0, 'masculino')">
            <div *ngIf="isUploading(phrase._id, 0, 'masculino')" class="spinner"></div>
            <button *ngIf="getAudioUrl(phrase.translations[0], 'masculino') as audioUrl; else promptMasculino" (click)="playAudio(audioUrl)" class="flex items-center justify-center w-32 h-12 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600">
              <svg *ngIf="!isPlaying(audioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <svg *ngIf="isPlaying(audioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <span>{{ isPlaying(audioUrl) ? 'Pausa' : 'Play' }}</span>
            </button>
            <ng-template #promptMasculino>
              <div *ngIf="!isUploading(phrase._id, 0, 'masculino')" class="text-gray-500">Arrastra audio (M)</div>
            </ng-template>
          </div>
        </div>

        <div *ngIf="phrase.translations.length > 0" class="audio-slot">
          <label class="font-bold text-gray-600 block mb-2">Voz Femenina</label>
          <div class="drop-zone h-28 flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg" appDragAndDrop (fileDropped)="onFileDropped($event, phrase._id, 0, 'femenino')">
            <div *ngIf="isUploading(phrase._id, 0, 'femenino')" class="spinner"></div>
            <button *ngIf="getAudioUrl(phrase.translations[0], 'femenino') as audioUrl; else promptFemenino" (click)="playAudio(audioUrl)" class="flex items-center justify-center w-32 h-12 bg-pink-500 text-white font-semibold rounded-lg shadow-md hover:bg-pink-600">
              <svg *ngIf="!isPlaying(audioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <svg *ngIf="isPlaying(audioUrl)" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
              <span>{{ isPlaying(audioUrl) ? 'Pausa' : 'Play' }}</span>
            </button>
            <ng-template #promptFemenino>
              <div *ngIf="!isUploading(phrase._id, 0, 'femenino')" class="text-gray-500">Arrastra audio (F)</div>
            </ng-template>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>